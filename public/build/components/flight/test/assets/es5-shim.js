// vim: ts=4 sts=4 sw=4 expandtab
// -- kriskowal Kris Kowal Copyright (C) 2009-2011 MIT License
// -- tlrobinson Tom Robinson Copyright (C) 2009-2010 MIT License (Narwhal Project)
// -- dantman Daniel Friesen Copyright (C) 2010 XXX TODO License or CLA
// -- fschaefer Florian Schäfer Copyright (C) 2010 MIT License
// -- Gozala Irakli Gozalishvili Copyright (C) 2010 MIT License
// -- kitcambridge Kit Cambridge Copyright (C) 2011 MIT License
// -- kossnocorp Sasha Koss XXX TODO License or CLA
// -- bryanforbes Bryan Forbes XXX TODO License or CLA
// -- killdream Quildreen Motta Copyright (C) 2011 MIT Licence
// -- michaelficarra Michael Ficarra Copyright (C) 2011 3-clause BSD License
// -- sharkbrainguy Gerard Paapu Copyright (C) 2011 MIT License
// -- bbqsrc Brendan Molloy (C) 2011 Creative Commons Zero (public domain)
// -- iwyg XXX TODO License or CLA
// -- DomenicDenicola Domenic Denicola Copyright (C) 2011 MIT License
// -- xavierm02 Montillet Xavier Copyright (C) 2011 MIT License
// -- Raynos Raynos XXX TODO License or CLA
// -- samsonjs Sami Samhuri Copyright (C) 2010 MIT License
// -- rwldrn Rick Waldron Copyright (C) 2011 MIT License
// -- lexer Alexey Zakharov XXX TODO License or CLA

/*!
    Copyright (c) 2009, 280 North Inc. http://280north.com/
    MIT License. http://github.com/280north/narwhal/blob/master/README.md
*/

(function(t){"function"==typeof define?define(t):t()})(function(){function t(t){try{return Object.defineProperty(t,"sentinel",{}),"sentinel"in t}catch(e){}}Function.prototype.bind||(Function.prototype.bind=function(t){var e=this;if("function"!=typeof e)throw new TypeError;var n=u.call(arguments,1),i=function(){if(this instanceof i){var o=function(){};o.prototype=e.prototype;var r=new o,s=e.apply(r,n.concat(u.call(arguments)));return null!==s&&Object(s)===s?s:r}return e.apply(t,n.concat(u.call(arguments)))};return i});var e,n,i,o,r,s=Function.prototype.call,a=Array.prototype,c=Object.prototype,u=a.slice,l=s.bind(c.toString),p=s.bind(c.hasOwnProperty);if((r=p(c,"__defineGetter__"))&&(e=s.bind(c.__defineGetter__),n=s.bind(c.__defineSetter__),i=s.bind(c.__lookupGetter__),o=s.bind(c.__lookupSetter__)),Array.isArray||(Array.isArray=function(t){return"[object Array]"==l(t)}),Array.prototype.forEach||(Array.prototype.forEach=function(t){var e=T(this),n=arguments[1],i=0,o=e.length>>>0;if("[object Function]"!=l(t))throw new TypeError;for(;o>i;)i in e&&t.call(n,e[i],i,e),i++}),Array.prototype.map||(Array.prototype.map=function(t){var e=T(this),n=e.length>>>0,i=Array(n),o=arguments[1];if("[object Function]"!=l(t))throw new TypeError;for(var r=0;n>r;r++)r in e&&(i[r]=t.call(o,e[r],r,e));return i}),Array.prototype.filter||(Array.prototype.filter=function(t){var e=T(this),n=e.length>>>0,i=[],o=arguments[1];if("[object Function]"!=l(t))throw new TypeError;for(var r=0;n>r;r++)r in e&&t.call(o,e[r],r,e)&&i.push(e[r]);return i}),Array.prototype.every||(Array.prototype.every=function(t){var e=T(this),n=e.length>>>0,i=arguments[1];if("[object Function]"!=l(t))throw new TypeError;for(var o=0;n>o;o++)if(o in e&&!t.call(i,e[o],o,e))return!1;return!0}),Array.prototype.some||(Array.prototype.some=function(t){var e=T(this),n=e.length>>>0,i=arguments[1];if("[object Function]"!=l(t))throw new TypeError;for(var o=0;n>o;o++)if(o in e&&t.call(i,e[o],o,e))return!0;return!1}),Array.prototype.reduce||(Array.prototype.reduce=function(t){var e=T(this),n=e.length>>>0;if("[object Function]"!=l(t))throw new TypeError;if(!n&&1==arguments.length)throw new TypeError;var i,o=0;if(arguments.length>=2)i=arguments[1];else for(;;){if(o in e){i=e[o++];break}if(++o>=n)throw new TypeError}for(;n>o;o++)o in e&&(i=t.call(void 0,i,e[o],o,e));return i}),Array.prototype.reduceRight||(Array.prototype.reduceRight=function(t){var e=T(this),n=e.length>>>0;if("[object Function]"!=l(t))throw new TypeError;if(!n&&1==arguments.length)throw new TypeError;var i,o=n-1;if(arguments.length>=2)i=arguments[1];else for(;;){if(o in e){i=e[o--];break}if(0>--o)throw new TypeError}do o in this&&(i=t.call(void 0,i,e[o],o,e));while(o--);return i}),Array.prototype.indexOf||(Array.prototype.indexOf=function(t){var e=T(this),n=e.length>>>0;if(!n)return-1;var i=0;for(arguments.length>1&&(i=S(arguments[1])),i=i>=0?i:Math.max(0,n+i);n>i;i++)if(i in e&&e[i]===t)return i;return-1}),Array.prototype.lastIndexOf||(Array.prototype.lastIndexOf=function(t){var e=T(this),n=e.length>>>0;if(!n)return-1;var i=n-1;for(arguments.length>1&&(i=Math.min(i,S(arguments[1]))),i=i>=0?i:n-Math.abs(i);i>=0;i--)if(i in e&&t===e[i])return i;return-1}),Object.getPrototypeOf||(Object.getPrototypeOf=function(t){return t.__proto__||(t.constructor?t.constructor.prototype:c)}),!Object.getOwnPropertyDescriptor){var h="Object.getOwnPropertyDescriptor called on a non-object: ";Object.getOwnPropertyDescriptor=function(t,e){if("object"!=typeof t&&"function"!=typeof t||null===t)throw new TypeError(h+t);if(p(t,e)){var n,s,a;if(n={enumerable:!0,configurable:!0},r){var u=t.__proto__;t.__proto__=c;var s=i(t,e),a=o(t,e);if(t.__proto__=u,s||a)return s&&(n.get=s),a&&(n.set=a),n}return n.value=t[e],n}}}if(Object.getOwnPropertyNames||(Object.getOwnPropertyNames=function(t){return Object.keys(t)}),Object.create||(Object.create=function(t,e){var n;if(null===t)n={__proto__:null};else{if("object"!=typeof t)throw new TypeError("typeof prototype["+typeof t+"] != 'object'");var i=function(){};i.prototype=t,n=new i,n.__proto__=t}return void 0!==e&&Object.defineProperties(n,e),n}),Object.defineProperty){var f=t({}),d="undefined"==typeof document||t(document.createElement("div"));if(!f||!d)var m=Object.defineProperty}if(!Object.defineProperty||m){var y="Property description must be an object: ",v="Object.defineProperty called on non-object: ",g="getters & setters can not be defined on this javascript engine";Object.defineProperty=function(t,s,a){if("object"!=typeof t&&"function"!=typeof t||null===t)throw new TypeError(v+t);if("object"!=typeof a&&"function"!=typeof a||null===a)throw new TypeError(y+a);if(m)try{return m.call(Object,t,s,a)}catch(u){}if(p(a,"value"))if(r&&(i(t,s)||o(t,s))){var l=t.__proto__;t.__proto__=c,delete t[s],t[s]=a.value,t.__proto__=l}else t[s]=a.value;else{if(!r)throw new TypeError(g);p(a,"get")&&e(t,s,a.get),p(a,"set")&&n(t,s,a.set)}return t}}Object.defineProperties||(Object.defineProperties=function(t,e){for(var n in e)p(e,n)&&"__proto__"!=n&&Object.defineProperty(t,n,e[n]);return t}),Object.seal||(Object.seal=function(t){return t}),Object.freeze||(Object.freeze=function(t){return t});try{Object.freeze(function(){})}catch(b){Object.freeze=function(t){return function(e){return"function"==typeof e?e:t(e)}}(Object.freeze)}if(Object.preventExtensions||(Object.preventExtensions=function(t){return t}),Object.isSealed||(Object.isSealed=function(){return!1}),Object.isFrozen||(Object.isFrozen=function(){return!1}),Object.isExtensible||(Object.isExtensible=function(t){if(Object(t)===t)throw new TypeError;for(var e="";p(t,e);)e+="?";t[e]=!0;var n=p(t,e);return delete t[e],n}),!Object.keys){var j=!0,w=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],x=w.length;for(var _ in{toString:null})j=!1;Object.keys=function(t){if("object"!=typeof t&&"function"!=typeof t||null===t)throw new TypeError("Object.keys called on a non-object");var e=[];for(var n in t)p(t,n)&&e.push(n);if(j)for(var i=0,o=x;o>i;i++){var r=w[i];p(t,r)&&e.push(r)}return e}}Date.prototype.toISOString&&-1!==new Date(-621987552e5).toISOString().indexOf("-000001")||(Date.prototype.toISOString=function(){var t,e,n,i;if(!isFinite(this))throw new RangeError;for(t=[this.getUTCMonth()+1,this.getUTCDate(),this.getUTCHours(),this.getUTCMinutes(),this.getUTCSeconds()],i=this.getUTCFullYear(),i=(0>i?"-":i>9999?"+":"")+("00000"+Math.abs(i)).slice(i>=0&&9999>=i?-4:-6),e=t.length;e--;)n=t[e],10>n&&(t[e]="0"+n);return i+"-"+t.slice(0,2).join("-")+"T"+t.slice(2).join(":")+"."+("000"+this.getUTCMilliseconds()).slice(-3)+"Z"}),Date.now||(Date.now=function(){return(new Date).getTime()}),Date.prototype.toJSON||(Date.prototype.toJSON=function(){if("function"!=typeof this.toISOString)throw new TypeError;return this.toISOString()}),Date.parse&&864e13===Date.parse("+275760-09-13T00:00:00.000Z")||(Date=function(t){var e=function e(n,i,o,r,s,a,c){var u=arguments.length;if(this instanceof t){var l=1==u&&n+""===n?new t(e.parse(n)):u>=7?new t(n,i,o,r,s,a,c):u>=6?new t(n,i,o,r,s,a):u>=5?new t(n,i,o,r,s):u>=4?new t(n,i,o,r):u>=3?new t(n,i,o):u>=2?new t(n,i):u>=1?new t(n):new t;return l.constructor=e,l}return t.apply(this,arguments)},n=RegExp("^(\\d{4}|[+-]\\d{6})(?:-(\\d{2})(?:-(\\d{2})(?:T(\\d{2}):(\\d{2})(?::(\\d{2})(?:\\.(\\d{3}))?)?(?:Z|(?:([-+])(\\d{2}):(\\d{2})))?)?)?)?$");for(var i in t)e[i]=t[i];return e.now=t.now,e.UTC=t.UTC,e.prototype=t.prototype,e.prototype.constructor=e,e.parse=function(e){var i=n.exec(e);if(i){i.shift();for(var o=1;7>o;o++)i[o]=+(i[o]||(3>o?1:0)),1==o&&i[o]--;var r=+i.pop(),s=+i.pop(),a=i.pop(),c=0;if(a){if(s>23||r>59)return 0/0;c=6e4*(60*s+r)*("+"==a?-1:1)}var u=+i[0];return u>=0&&99>=u?(i[0]=u+400,t.UTC.apply(this,i)+c-126227808e5):t.UTC.apply(this,i)+c}return t.parse.apply(this,arguments)},e}(Date));var E="	\n\f\r   ᠎             　\u2028\u2029﻿";if(!String.prototype.trim||E.trim()){E="["+E+"]";var C=RegExp("^"+E+E+"*"),k=RegExp(E+E+"*$");String.prototype.trim=function(){return(this+"").replace(C,"").replace(k,"")}}var S=function(t){return t=+t,t!==t?t=0:0!==t&&t!==1/0&&t!==-(1/0)&&(t=(t>0||-1)*Math.floor(Math.abs(t))),t},O="a"!="a"[0],T=function(t){if(null==t)throw new TypeError;return O&&"string"==typeof t&&t?t.split(""):Object(t)}});