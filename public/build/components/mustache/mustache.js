/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */

var Mustache,Mustache;(function(e){"undefined"!=typeof module&&module.exports?module.exports=e:"function"==typeof define?define(e):Mustache=e})(function(){function e(e,t){return RegExp.prototype.test.call(e,t)}function t(t){return!e(m,t)}function n(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function i(e){return(e+"").replace(/[&<>"'\/]/g,function(e){return x[e]})}function r(e){this.string=e,this.tail=e,this.pos=0}function o(e,t){this.view=e,this.parent=t,this.clearCache()}function s(){this.clearCache()}function a(e){for(var t,n=e[3],i=n;(t=e[4])&&t.length;)e=t[t.length-1],i=e[3];return[n,i]}function c(e){function t(e,t,i){if(!n[e]){var r=c(t);n[e]=function(e,t){return r(e,t,i)}}return n[e]}var n={};return function(n,i,r){for(var o,s,c="",u=0,l=e.length;l>u;++u)switch(o=e[u],o[0]){case"#":s=r.slice.apply(r,a(o)),c+=n._section(o[1],i,s,t(u,o[4],r));break;case"^":c+=n._inverted(o[1],i,t(u,o[4],r));break;case">":c+=n._partial(o[1],i);break;case"&":c+=n._name(o[1],i);break;case"name":c+=n._escaped(o[1],i);break;case"text":c+=o[1]}return c}}function u(e){for(var t,n,i=[],r=i,o=[],s=0;e.length>s;++s)switch(t=e[s],t[0]){case"#":case"^":t[4]=[],o.push(t),r.push(t),r=t[4];break;case"/":if(0===o.length)throw Error("Unopened section: "+t[1]);if(n=o.pop(),n[1]!==t[1])throw Error("Unclosed section: "+n[1]);r=o.length>0?o[o.length-1][4]:i;break;default:r.push(t)}if(n=o.pop())throw Error("Unclosed section: "+n[1]);return i}function l(e){for(var t,n,i=[],r=0;e.length>r;++r)t=e[r],n&&"text"===n[0]&&"text"===t[0]?(n[1]+=t[1],n[3]=t[3]):(n=t,i.push(t));return i}function p(e){if(2!==e.length)throw Error("Invalid tags: "+e.join(" "));return[RegExp(n(e[0])+"\\s*"),RegExp("\\s*"+n(e[1]))]}var h={};h.name="mustache.js",h.version="0.7.1",h.tags=["{{","}}"],h.Scanner=r,h.Context=o,h.Writer=s;var f=/\s*/,d=/\s+/,m=/\S/,y=/\s*=/,g=/\s*\}/,v=/#|\^|\/|>|\{|&|=|!/,b=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},x={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};h.escape=i,r.prototype.eos=function(){return""===this.tail},r.prototype.scan=function(e){var t=this.tail.match(e);return t&&0===t.index?(this.tail=this.tail.substring(t[0].length),this.pos+=t[0].length,t[0]):""},r.prototype.scanUntil=function(e){var t,n=this.tail.search(e);switch(n){case-1:t=this.tail,this.pos+=this.tail.length,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,n),this.tail=this.tail.substring(n),this.pos+=n}return t},o.make=function(e){return e instanceof o?e:new o(e)},o.prototype.clearCache=function(){this._cache={}},o.prototype.push=function(e){return new o(e,this)},o.prototype.lookup=function(e){var t=this._cache[e];if(!t){if("."===e)t=this.view;else for(var n=this;n;){if(e.indexOf(".")>0){var i=e.split("."),r=0;for(t=n.view;t&&i.length>r;)t=t[i[r++]]}else t=n.view[e];if(null!=t)break;n=n.parent}this._cache[e]=t}return"function"==typeof t&&(t=t.call(this.view)),t},s.prototype.clearCache=function(){this._cache={},this._partialCache={}},s.prototype.compile=function(e,t){var n=this._cache[e];if(!n){var i=h.parse(e,t);n=this._cache[e]=this.compileTokens(i,e)}return n},s.prototype.compilePartial=function(e,t,n){var i=this.compile(t,n);return this._partialCache[e]=i,i},s.prototype.compileTokens=function(e,t){var n=c(e),i=this;return function(e,r){if(r)if("function"==typeof r)i._loadPartial=r;else for(var s in r)i.compilePartial(s,r[s]);return n(i,o.make(e),t)}},s.prototype.render=function(e,t,n){return this.compile(e)(t,n)},s.prototype._section=function(e,t,n,i){var r=t.lookup(e);switch(typeof r){case"object":if(b(r)){for(var o="",s=0,a=r.length;a>s;++s)o+=i(this,t.push(r[s]));return o}return r?i(this,t.push(r)):"";case"function":var c=this,u=function(e){return c.render(e,t)},l=r.call(t.view,n,u);return null!=l?l:"";default:if(r)return i(this,t)}return""},s.prototype._inverted=function(e,t,n){var i=t.lookup(e);return!i||b(i)&&0===i.length?n(this,t):""},s.prototype._partial=function(e,t){e in this._partialCache||!this._loadPartial||this.compilePartial(e,this._loadPartial(e));var n=this._partialCache[e];return n?n(t):""},s.prototype._name=function(e,t){var n=t.lookup(e);return"function"==typeof n&&(n=n.call(t.view)),null==n?"":n+""},s.prototype._escaped=function(e,t){return h.escape(this._name(e,t))},h.parse=function(e,i){function o(){if(k&&!T)for(;j.length;)w.splice(j.pop(),1);else j=[];k=!1,T=!1}e=e||"",i=i||h.tags;for(var s,a,c,m,b=p(i),x=new r(e),w=[],j=[],k=!1,T=!1;!x.eos();){if(s=x.pos,c=x.scanUntil(b[0]))for(var S=0,_=c.length;_>S;++S)m=c.charAt(S),t(m)?j.push(w.length):T=!0,w.push(["text",m,s,s+1]),s+=1,"\n"===m&&o();if(s=x.pos,!x.scan(b[0]))break;if(k=!0,a=x.scan(v)||"name",x.scan(f),"="===a)c=x.scanUntil(y),x.scan(y),x.scanUntil(b[1]);else if("{"===a){var E=RegExp("\\s*"+n("}"+i[1]));c=x.scanUntil(E),x.scan(g),x.scanUntil(b[1]),a="&"}else c=x.scanUntil(b[1]);if(!x.scan(b[1]))throw Error("Unclosed tag at "+x.pos);w.push([a,c,s,x.pos]),("name"===a||"{"===a||"&"===a)&&(T=!0),"="===a&&(i=c.split(d),b=p(i))}return w=l(w),u(w)};var w=new s;return h.clearCache=function(){return w.clearCache()},h.compile=function(e,t){return w.compile(e,t)},h.compilePartial=function(e,t,n){return w.compilePartial(e,t,n)},h.compileTokens=function(e,t){return w.compileTokens(e,t)},h.render=function(e,t,n){return w.render(e,t,n)},h.to_html=function(e,t,n,i){var r=h.render(e,t,n);return"function"!=typeof i?r:(i(r),void 0)},h}());